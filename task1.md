# Исследование выбора хранилища данных для онлайн-кинотеатра

## Введение

Как и в предыдущей теме, необходимо провести исследование по выбору хранилища данных и определить модель их хранения. Однако требования изменились:

- **Требования к максимальным объёмам данных:** `S(<DataType>)`
- **Требования к скорости обработки данных:** не более **200 мс**

### Набор данных, подлежащих хранению

- лайки пользователей к каждому фильму;
- рецензии к фильмам;
- закладки пользователей (фильмы «на потом»).

---

## Описание данных

### Лайки

Лайки представляют собой пользовательскую оценку фильма в диапазоне от **0 до 10**.

- `10` — лайк  
- `0` — дизлайк  

На основе всех оценок формируется пользовательский рейтинг фильма.

Важно: поведение лайков с точки зрения бизнеса может изменяться (простая модель лайк/дизлайк или шкала 0–10), поэтому **с самого начала необходимо закладывать хранение значения типа `smallint`**.

#### Сценарии использования

- просмотр количества лайков и дизлайков у фильма;
- просмотр средней пользовательской оценки фильма;
- добавление, удаление и изменение лайка/дизлайка/оценки.

---

### Рецензии к фильмам

Рецензия состоит из нескольких частей:

1. **Основные данные**
   - текст рецензии;

2. **Дополнительные атрибуты**
   - дата публикации;
   - автор;
   - прочие метаданные;

3. **Данные из смежных сущностей**
   - лайки и дизлайки рецензии;
   - оценка фильма пользователем, связанная с рецензией.

Рецензию может написать любой пользователь. Для выделения наиболее полезных рецензий пользователи могут голосовать за них (лайк/дизлайк).

Важно учитывать, что:
- сортировка только по количеству лайков может приводить к доминированию старых рецензий;
- алгоритмы ранжирования будут дорабатываться позже.

На текущем этапе необходимо **заложить возможность гибкой сортировки**, включая сортировку по данным из смежных таблиц.

#### Сценарии использования

- добавление рецензии к фильму;
- добавление лайка или дизлайка к рецензии;
- просмотр списка рецензий с возможностью гибкой сортировки.

---

### Закладки пользователя

Закладки — это связь пользователя с фильмом, который он хочет посмотреть позже.

Особенности:
- у большинства пользователей количество закладок невелико;
- сортировка не требуется или выполняется по времени добавления.

#### Сценарии использования

- добавление фильма в закладки;
- удаление фильма из закладок;
- просмотр списка закладок пользователя.

---

### Дополнительные данные

Вы можете предложить собственную функциональность онлайн-кинотеатра, которая требует хранения и обработки больших объёмов данных.  
В исследовании допускается описание:
- структуры этих данных;
- сценариев использования;
- особенностей хранения и доступа.

---

## Архитектурные варианты реализации

На данный момент уже существует сервис, работающий с историями просмотров. Возможны два подхода:

### Вариант 1. Расширение существующего сервиса

**Плюсы:**
- сервис уже развернут и работает;
- не требуется отдельная инфраструктура.

**Минусы:**
- увеличение зоны ответственности сервиса;
- рост требований к надёжности и производительности;
- ограничение выбором одного хранилища под все сценарии, чтобы избежать «зоопарка технологий».

---

### Вариант 2. Разработка отдельного сервиса

**Плюсы:**
- возможность выбрать хранилище под конкретные задачи;
- более гибкая архитектура;
- масштабирование под нужды сервиса.

**Минусы:**
- усложнение поддержки проекта;
- необходимость отдельной инфраструктуры;
- потенциальная потребность в выделенной команде.

---

## Задача исследования

Необходимо провести исследование по выбору хранилища, следуя чек-листу:

1. Выбрать хранилище данных.
2. Написать скрипт генерации тестовых данных.
3. Измерить скорость записи и чтения данных.

### Тестирование чтения уже загруженных данных

Выбрать **2–3 реальных кейса** из списка:

- список лайков пользователя (понравившиеся фильмы);
- количество лайков и дизлайков у фильма;
- список закладок пользователя;
- средняя пользовательская оценка фильма.

### Тестирование данных в реальном времени

- добавление лайка или дизлайка;
- время появления изменений в сценариях, описанных выше.

4. Обосновать архитектурное решение:
   - разработка отдельного сервиса **или**
   - добавление функциональности в существующий сервис.

---

## Итоги исследования

По результатам исследования должны быть получены:

### 1. Выбранное хранилище

- описание хранилища;
- причины выбора;
- схема хранения данных.

### 2. Результаты тестирования

- показатели скорости чтения и записи;
- оформлены в формате **README.md**.

### 3. Файлы для воспроизведения исследования

- `docker-compose.yml` для запуска кластера хранилища;
- конфигурационные файлы хранилища (при наличии);
- скрипт генерации данных;
- скрипт тестирования чтения данных;
- `README.md` с инструкциями по запуску.

### 4. Описание архитектурного решения

- реализация отдельного сервиса  
  - почему выбран этот подход;
  - возможные проблемы;

- добавление в существующий сервис  
  - почему выбран этот подход;
  - возможные проблемы.

Все результаты необходимо оформить и обсудить с наставником в **Пачке**.

---

## Подсказки

**Подсказка 1**  
Для данной задачи скорость записи менее критична, чем скорость чтения.  
**Скорость чтения — ключевой критерий выбора хранилища.**

**Подсказка 2**  
При выборе хранилища учитывайте:
- сильные и слабые стороны СУБД;
- тип движка хранения данных.

Например, в LSM-Tree запись выполняется быстрее, чем чтение, однако такие движки всё равно применяются в ряде баз данных.
