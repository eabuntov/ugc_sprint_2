# –û—Ç—á–µ—Ç –æ —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â

## 1. –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

–¶–µ–ª—å—é –¥–∞–Ω–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è –≤—ã–±–æ—Ä –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –æ–Ω–ª–∞–π–Ω-–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞, –≥–¥–µ **–∫–ª—é—á–µ–≤—ã–º –∫—Ä–∏—Ç–µ—Ä–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è —Å–∫–æ—Ä–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è**, –∞ –Ω–µ –∑–∞–ø–∏—Å–∏.

–°—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã–µ –°–£–ë–î:

* **ClickHouse** (–∫–æ–ª–æ–Ω–æ—á–Ω–æ–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, OLAP)
* **MongoDB** (–¥–æ–∫—É–º–µ–Ω—Ç–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –°–£–ë–î, OLTP/OLAP hybrid)

---

## 2. –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

–í —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–ª–∏—Å—å —Å–ª–µ–¥—É—é—â–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏:

### 2.1 –õ–∞–π–∫–∏ —Ñ–∏–ª—å–º–æ–≤

* user_id
* movie_id
* rating (0‚Äì10)
* timestamp

### 2.2 –†–µ—Ü–µ–Ω–∑–∏–∏

* review_id
* movie_id
* user_id (–∞–≤—Ç–æ—Ä)
* —Ç–µ–∫—Å—Ç —Ä–µ—Ü–µ–Ω–∑–∏–∏
* –¥–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
* –æ—Ü–µ–Ω–∫–∞ —Ñ–∏–ª—å–º–∞ –∞–≤—Ç–æ—Ä–æ–º

### 2.3 –†–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Ä–µ—Ü–µ–Ω–∑–∏–∏

* review_id
* user_id
* reaction (like / dislike)
* timestamp

### 2.4 –ó–∞–∫–ª–∞–¥–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

* user_id
* movie_id
* timestamp

---

## 3. –§–∏–∑–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã

### ClickHouse

* –î–≤–∏–∂–æ–∫: `MergeTree`
* –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –¥–∞—Ç–µ
* –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `(movie_id, user_id)` –∏–ª–∏ `(user_id, movie_id)`
* –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è —á–µ—Ä–µ–∑ `GROUP BY`

### MongoDB

* –û—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏:

  * likes
  * reviews
  * review_reactions
  * bookmarks
* –ò–Ω–¥–µ–∫—Å—ã:

  * `{ user_id: 1 }`
  * `{ movie_id: 1 }`
  * —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –ø–æ–¥ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —á—Ç–µ–Ω–∏—è

---

## 4. –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–µ–Ω–¥–∞

–°—Ç–µ–Ω–¥ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker Compose –∏ –≤–∫–ª—é—á–∞–µ—Ç:

* ClickHouse (single-node)
* MongoDB (single primary)
* ingest-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (bulk + realtime –∑–∞–≥—Ä—É–∑–∫–∞)
* benchmark-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (read + realtime visibility —Ç–µ—Å—Ç—ã)

–í—Å–µ —Ç–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –≤ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö, –±–µ–∑ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.

---

## 5. –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 5.1 Bulk ingest

* –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ñ–ª–∞–π–Ω
* –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞—á–∫–∞–º–∏ (10k‚Äì100k –∑–∞–ø–∏—Å–µ–π)
* –¶–µ–ª—å: –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

### 5.2 Read benchmarks (–æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–∫—É—Å)

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

1. –°–ø–∏—Å–æ–∫ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏—Ö—Å—è —Ñ–∏–ª—å–º–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∞–π–∫–æ–≤ / –¥–∏–∑–ª–∞–π–∫–æ–≤ —Ñ–∏–ª—å–º–∞
3. –°–ø–∏—Å–æ–∫ –∑–∞–∫–ª–∞–¥–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –°—Ä–µ–¥–Ω—è—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞ —Ñ–∏–ª—å–º–∞

–ú–µ—Ç—Ä–∏–∫–∞:

* latency (ms)
* p50 / p95 / p99

### 5.3 Realtime visibility

–ò–∑–º–µ—Ä—è–ª–æ—Å—å –≤—Ä–µ–º—è –æ—Ç –º–æ–º–µ–Ω—Ç–∞ –∑–∞–ø–∏—Å–∏ —Å–æ–±—ã—Ç–∏—è –¥–æ –µ–≥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö —á—Ç–µ–Ω–∏—è.

–ú–µ—Ç–æ–¥:

* –∑–∞–ø–∏—Å—å –æ–¥–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
* polling —á—Ç–µ–Ω–∏—è —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 5‚Äì10 –º—Å
* —Ñ–∏–∫—Å–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–µ—Ä–≤–æ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏

---

## 6. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 6.1 Read performance

| –°—Ü–µ–Ω–∞—Ä–∏–π           | ClickHouse p50 | ClickHouse p95 | MongoDB p50 | MongoDB p95 |
| ------------------ | -------------- | -------------- | ----------- | ----------- |
| –õ–∞–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | 3‚Äì5 ms         | 10‚Äì20 ms       | 5‚Äì8 ms      | 20‚Äì30 ms    |
| –õ–∞–π–∫–∏ —Ñ–∏–ª—å–º–∞       | 2‚Äì4 ms         | 8‚Äì15 ms        | 6‚Äì10 ms     | 25‚Äì40 ms    |
| –ó–∞–∫–ª–∞–¥–∫–∏           | 3‚Äì6 ms         | 12‚Äì20 ms       | 4‚Äì7 ms      | 15‚Äì25 ms    |
| –°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞     | 2‚Äì3 ms         | 6‚Äì10 ms        | 8‚Äì12 ms     | 30‚Äì50 ms    |

**–í—ã–≤–æ–¥:** ClickHouse –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—É—é –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

---

### 6.2 Realtime visibility

| –•—Ä–∞–Ω–∏–ª–∏—â–µ  | p50       | p95        | p99    | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π                      |
| ---------- | --------- | ---------- | ------ | -------------------------------- |
| MongoDB    | 1‚Äì5 ms    | <10 ms     | <20 ms | –ü–æ—á—Ç–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å |
| ClickHouse | 30‚Äì150 ms | 300‚Äì800 ms | –¥–æ 2 s | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ MergeTree    |

---

## 7. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### ClickHouse

**–ü–ª—é—Å—ã:**

* –û—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
* –û—Ç–ª–∏—á–Ω–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
* –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–∞—è latency –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö –¥–∞–Ω–Ω—ã—Ö

**–ú–∏–Ω—É—Å—ã:**

* –û—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
* –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è strict realtime UX

### MongoDB

**–ü–ª—é—Å—ã:**

* –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å –∑–∞–ø–∏—Å–µ–π
* –ü—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è transactional —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

**–ú–∏–Ω—É—Å—ã:**

* –ë–æ–ª–µ–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã
* –†–æ—Å—Ç latency —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

---

## 8. –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–±–æ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

–° —É—á–µ—Ç–æ–º —Ç–æ–≥–æ, —á—Ç–æ:

* **—Å–∫–æ—Ä–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è –≥–ª–∞–≤–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏–µ–º**,
* –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏,
* –¥–æ–ø—É—Å—Ç–∏–º–∞ –Ω–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ realtime-–≤–∏–¥–∏–º–æ—Å—Ç–∏,

### üëâ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ: ClickHouse**

---

## 9. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è **–≥–∏–±—Ä–∏–¥–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:

* MongoDB ‚Äî –¥–ª—è realtime UI –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
* ClickHouse ‚Äî –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, –æ—Ç—á–µ—Ç–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

---

## 10. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

ClickHouse –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç MongoDB –≤ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö —á—Ç–µ–Ω–∏—è –∏ –ª—É—á—à–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∑–∞–¥–∞—á–∏. MongoDB —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å—Ç—Ä–æ–≥–∏—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö –∫ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.

–î–∞–Ω–Ω—ã–π —Å—Ç–µ–Ω–¥ –∏ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —ç—Ç–æ—Ç –≤—ã–≤–æ–¥ –∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥—Ä—É–≥–∏—Ö –°–£–ë–î.
